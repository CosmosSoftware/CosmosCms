@using NonFactors.Mvc.Grid
@model IQueryable<TemplateIndexViewModel>
@{
    Layout = "_Layout";
    ViewData["Title"] = "Page Template List";
}

<div class="container mt-5 pt-2">
    <div class="row">
        <div class="col">
            <h3>@ViewData["Title"]</h3>
            <hr />
            <p>Page templates are pre-build web pages that can help quickly build your website.</p>
            <p>Create a new template by clicking &quot;New&quot; below.</p>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            @(
                Html.Grid(Model)
                .Build(col =>
                {
                    col.Add().RenderedAs(m =>
                    "<div class=\"btn-group\" role=\"group\" aria-label=\"Basic example\">" +
                    $"<a class=\"btn btn-sm btn-secondary\" href=\"{Url.Action("Preview", "Templates")}/{m.Id}\" title=\"Preview\"><span class=\"fa fa-binoculars\"></span></a>" +
                    $"<a class=\"btn btn-sm btn-secondary\" href=\"{Url.Action("EditCode", "Templates")}/{m.Id}\" title=\"Edit Code\"><span class=\"fa fa-edit\"></span></a>" +
                    "</div>").Encoded(false).Titled("");

                    col.Add(m => m.LayoutName);
                    col.Add(m => m.Title);

                    col.Add().RenderedAs(m => $"<button type='button' onclick='selectId(\"" + m.Id + "\")' class='btn btn-sm btn-secondary' data-bs-toggle='modal' data-bs-target='#delConfModal'><i title='Send to trash' class='fa-solid fa-trash'></i></button>").Encoded(false).Titled("");
                })
                .Using(NonFactors.Mvc.Grid.GridFilterMode.Header)
                .Empty("No templates found")
                .Filterable()
                .Sortable()
                .Pageable()
                )
        </div>
    </div>
</div>


<script>
    var templateId;

    function selectId(id) {
        templateId = id;
        return true;
    }

    function sendToTrash() {
        window.location.href = "@Url.Action("Trash", "Templates")/" + templateId;
    }

</script>

<!-- Modal -->
<div class="modal fade" id="delConfModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this template?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="sendToTrash()">Confirm</button>
            </div>
        </div>
    </div>
</div>